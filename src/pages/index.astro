---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import heroImage from '../assets/hero-home.png';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<section class="hero">
				<div class="hero-image">
					<Image src={heroImage} alt="Dev Journal" />
				</div>
				<h1>Dev Journal</h1>
				<p class="tagline">Thoughts on code, life, and everything in between.</p>
			</section>

			<section class="posts">
				<h2>Recent Posts</h2>
				<ul>
					{posts.map((post) => (
						<li>
							<a href={`/blog/${post.id}/`}>
								<span class="title">{post.data.title}</span>
								<span class="date">
									{post.data.pubDate.toLocaleDateString('en-us', {
										year: 'numeric',
										month: 'short',
										day: 'numeric',
									})}
								</span>
							</a>
						</li>
					))}
				</ul>
			</section>
		</main>
		<Footer />
		<style>
			.hero {
				margin-bottom: 3em;
				text-align: center;
			}
			.hero-image {
				margin-bottom: 2em;
				border-radius: 12px;
				overflow: hidden;
			}
			.hero-image img {
				width: 100%;
				max-height: 300px;
				object-fit: cover;
			}
			.hero h1 {
				margin-bottom: 0.25em;
			}
			.tagline {
				color: var(--text-muted);
				font-size: 1.1em;
			}
			.posts h2 {
				font-size: 1.25em;
				margin-bottom: 1em;
				color: var(--text-muted);
			}
			.posts ul {
				list-style: none;
				padding: 0;
				margin: 0;
			}
			.posts li {
				margin-bottom: 0.75em;
			}
			.posts a {
				display: flex;
				justify-content: space-between;
				align-items: baseline;
				gap: 1em;
				padding: 0.75em 0;
				border-bottom: 1px solid var(--border);
				text-decoration: none;
			}
			.posts a:hover {
				background: var(--bg-secondary);
				margin: 0 -0.5em;
				padding: 0.75em 0.5em;
				border-radius: 4px;
				border-bottom-color: transparent;
			}
			.posts .title {
				color: var(--text);
			}
			.posts .date {
				color: var(--text-muted);
				font-size: 0.85em;
				white-space: nowrap;
			}
		</style>
	</body>
</html>